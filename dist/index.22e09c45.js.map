{"mappings":"AA6IY,IA1IZ,MACEA,GAAOC,EAAED,IAAI,OAAOE,QAAQ,CAAC,EAAG,GAAI,GACpCC,GAAQC,SAASC,cAAc,cAC/BC,GAAuBF,SAASC,cAAc,2BAC9CE,GAAwBH,SAASC,cAAc,4BAC/CG,GAAiBJ,SAASC,cAAc,mBACxCI,GAAgBL,SAASC,cAAc,kBAEvCK,cACEC,KAAKC,UAAUD,MAAKX,GACpBW,KAAKE,sBACLF,KAAKG,qBAGPF,UAAUZ,GACRC,EAAEc,UAAU,oDAAqD,CAC/DC,QAAS,GACTC,WAAY,CAAC,MAAO,MAAO,MAAO,SACjCC,MAAMlB,GAGXmB,mBAAmBnB,GAxBrBoB,IAwB4BA,EAxB5BC,IAwBiCA,GAAQ,CAAED,IAAK,KAAMC,IAAK,OAASC,GAChEtB,EAAIE,QAAQ,CAACkB,EAAKC,GCnBL,IDoBbpB,EAAEsB,OAAO,CAACH,EAAKC,GAAM,CACnBG,KAAMvB,EAAEuB,KAAK,CACXC,QAAS,2BACTC,SAAU,CAAC,GAAI,QAGhBR,MAAMlB,GACN2B,UACC1B,EAAE2B,MAAM,CACNC,OAAQ,CAAC,GAAG,IACZC,WAAW,EACXC,cAAc,KAGjBC,gBAAgB,UAAUV,oBAC1BW,YAGLC,uBAAuBC,GACrBxB,MAAKL,EAAqB8B,UAAUC,OAAO,UAC3C1B,MAAKJ,EAAsB6B,UAAUE,IAAI,UACzC3B,MAAKF,EAAc8B,YAAcJ,EAGnCK,SACE7B,MAAKH,EAAeiC,UAAY,GAGlCC,mBACE,IACE,MAAMC,QAAiBC,MCxDd,qCD0DT,IAAKD,EAASE,GACZ,MAAM,IAAIC,MAAM,8BAA8BH,EAASI,WAEzD,MAAQC,GAAIC,SAAaN,EAASO,OAElC,OADA9C,SAAS+C,eAAe,iBAAiBC,MAAQH,EAC1CA,EACP,MAAOI,GACP,MAAMA,GAIVX,oBAAoBY,GAClB,IACE,MAAML,EAAKK,SAAkB3C,KAAK4C,aAC5BZ,QAAiBC,MCtEL,CAACK,GAChB,+FAA+FA,IDqErEO,CAAuBP,IAEpD,IAAKN,EAASE,GACZ,MAAM,IAAIC,MAAM,GAAGH,EAASc,eAAed,EAASI,WAGtD,aADmBJ,EAASO,OAE5B,MAAOG,GACP,MAAMA,GAIVX,0BAA0BY,GACxB,IACE,MACMI,SADa/C,KAAKgD,cAAcL,IACTM,GAAGC,MAAMC,MAAK,QAE3C,OADgBJ,EAAgBK,MAAM,EAAG,GAAGC,KAAK,KAEjD,MAAOX,GACP,MAAMA,GAIVX,0BAA0BY,GACxB,IACE,MAAMW,QAAiBtD,KAAKuD,oBAAoBZ,GAC1Ca,QAAaxD,KAAKgD,cAAcM,GAEtCtD,KAAKQ,mBACHR,MAAKX,EACL,CACEoB,IAAK+C,EAAKC,SAAShD,IACnBC,IAAK8C,EAAKC,SAAS/C,KAErB4C,GAGFtD,KAAK6B,SACL7B,MAAKL,EAAqB8B,UAAUE,IAAI,UACxC3B,MAAKH,EAAe6D,mBAClB,YEhHW,SAAUF,GAC3B,MAAO,irBFgHDG,CAAkBH,IAEpB,MAAOd,GACP1C,KAAKuB,uBAAuBmB,EAAMlB,UAItCrB,qBACEH,MAAKR,EAAMoE,iBAAiB,UAAWC,IACrCA,EAAEC,iBACF,MAAMC,EAAYtE,SAAS+C,eAAe,iBAAiBC,MAGD,IAApDsB,EAAUZ,MAAM,KAAKa,QAAQC,IAAQA,IAAIC,QAQ/ClE,MAAKJ,EAAsB6B,UAAUC,OAAO,UAE5C1B,KAAKE,oBAAoB6D,IATvB/D,KAAKuB,uBACH","sources":["app.js","config.js","markup.js"],"sourcesContent":["import * as config from \"/config.js\";\r\nimport * as render from \"/markup.js\";\r\n\r\nclass App {\r\n  #map = L.map(\"map\").setView([0, 0], 0);\r\n  #form = document.querySelector(\".main-form\");\r\n  #parentInfoContainer = document.querySelector(\".address-info-container\");\r\n  #parentErrorContainer = document.querySelector(\".error-message-container\");\r\n  #infoContainer = document.querySelector(\".info-container\");\r\n  #errorMessage = document.querySelector(\".error-message\");\r\n\r\n  constructor() {\r\n    this._load_map(this.#map);\r\n    this._load_location_data();\r\n    this._init_form_handler();\r\n  }\r\n\r\n  _load_map(map) {\r\n    L.tileLayer(\"http://{s}.google.com/vt/lyrs=m&x={x}&y={y}&z={z}\", {\r\n      maxZoom: 20,\r\n      subdomains: [\"mt0\", \"mt1\", \"mt2\", \"mt3\"],\r\n    }).addTo(map);\r\n  }\r\n\r\n  _load_location_map(map, { lat, lng } = { lat: 51.5, lng: 10.09 }, routeIP) {\r\n    map.setView([lat, lng], config.MAP_ZOOM);\r\n    L.marker([lat, lng], {\r\n      icon: L.icon({\r\n        iconUrl: `images/icon-location.svg`,\r\n        iconSize: [35, 40],\r\n      }),\r\n    })\r\n      .addTo(map)\r\n      .bindPopup(\r\n        L.popup({\r\n          offset: [0, -15],\r\n          autoClose: false,\r\n          closeOnClick: false,\r\n        })\r\n      )\r\n      .setPopupContent(`route (${routeIP}) located here `)\r\n      .openPopup();\r\n  }\r\n\r\n  _display_error_message(message) {\r\n    this.#parentInfoContainer.classList.remove(\"active\");\r\n    this.#parentErrorContainer.classList.add(\"active\");\r\n    this.#errorMessage.textContent = message;\r\n  }\r\n\r\n  _clear() {\r\n    this.#infoContainer.innerHTML = \"\";\r\n  }\r\n\r\n  async _get_my_IP() {\r\n    try {\r\n      const response = await fetch(config.GET_IP);\r\n\r\n      if (!response.ok)\r\n        throw new Error(`can't get your IP Address (${response.status})`);\r\n\r\n      const { ip: IP } = await response.json();\r\n      document.getElementById(\"address-input\").value = IP;\r\n      return IP;\r\n    } catch (error) {\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  async _get_res_data(address) {\r\n    try {\r\n      const IP = address ?? (await this._get_my_IP());\r\n      const response = await fetch(config.IP_COUNTRY_CITY(IP));\r\n\r\n      if (!response.ok)\r\n        throw new Error(`${response.statusText} (${response.status})`);\r\n\r\n      const data = await response.json();\r\n      return data;\r\n    } catch (error) {\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  async _get_route_location(address) {\r\n    try {\r\n      const data = await this._get_res_data(address);\r\n      const makeCorrectCase = data.as.route.split(/[./]/);\r\n      const routeIP = makeCorrectCase.slice(0, 4).join(\".\");\r\n      return routeIP;\r\n    } catch (error) {\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  async _load_location_data(address) {\r\n    try {\r\n      const exact_IP = await this._get_route_location(address);\r\n      const data = await this._get_res_data(exact_IP);\r\n\r\n      this._load_location_map(\r\n        this.#map,\r\n        {\r\n          lat: data.location.lat,\r\n          lng: data.location.lng,\r\n        },\r\n        exact_IP\r\n      );\r\n\r\n      this._clear();\r\n      this.#parentInfoContainer.classList.add(\"active\");\r\n      this.#infoContainer.insertAdjacentHTML(\r\n        \"beforeend\",\r\n        render.renderInfo(data)\r\n      );\r\n    } catch (error) {\r\n      this._display_error_message(error.message);\r\n    }\r\n  }\r\n\r\n  _init_form_handler() {\r\n    this.#form.addEventListener(\"submit\", (e) => {\r\n      e.preventDefault();\r\n      const userInput = document.getElementById(\"address-input\").value;\r\n\r\n      // validating if IP address case is really correct\r\n      if (!(userInput.split(\".\").filter((el) => +el).length === 4)) {\r\n        this._display_error_message(\r\n          \"Make sure your input value is an IP Address not domain\"\r\n        );\r\n        return;\r\n      }\r\n\r\n      // if ever previous error exist\r\n      this.#parentErrorContainer.classList.remove(\"active\");\r\n\r\n      this._load_location_data(userInput);\r\n    });\r\n  }\r\n}\r\n\r\nconst app = new App();\r\n","const GET_IP = \"https://api.ipify.org?format=json\";\r\n\r\nconst IP_COUNTRY_CITY = (IP) => {\r\n  return `https://geo.ipify.org/api/v2/country,city?apiKey=at_M8T0QaTcLNBS3u4PQZwHGam7ZvNJ4&ipAddress=${IP}`;\r\n};\r\n\r\nconst MAP_ZOOM = 12;\r\n\r\nexport { IP_COUNTRY_CITY, GET_IP, MAP_ZOOM };\r\n","const renderInfo = function (data) {\r\n  return `\r\n <div class=\"content\">\r\n              <p class=\"title\">IP ADDRESS</p>\r\n              <h2 class=\"title-content\">${data.ip}</h2>\r\n            </div>\r\n            <div class=\"content\">\r\n              <p class=\"title\">LOCATION</p>\r\n              <h2 class=\"title-content\">${data.location.city}, ${data.location.region}, ${data.location.postalCode}</h2>\r\n            </div>\r\n            <div class=\"content\">\r\n              <p class=\"title\">TIMEZONE</p>\r\n              <h2 class=\"title-content\">UTC${data.location.timezone}</h2>\r\n            </div>\r\n            <div class=\"content\">\r\n              <p class=\"title\">ISP</p>\r\n              <h2 class=\"title-content\">${data.isp}</h2>\r\n            </div>\r\n    `;\r\n};\r\n\r\nexport { renderInfo };\r\n"],"names":["map","L","setView","form","document","querySelector","parentInfoContainer","parentErrorContainer","infoContainer","errorMessage","constructor","this","_load_map","_load_location_data","_init_form_handler","tileLayer","maxZoom","subdomains","addTo","_load_location_map","lat","lng","routeIP","marker","icon","iconUrl","iconSize","bindPopup","popup","offset","autoClose","closeOnClick","setPopupContent","openPopup","_display_error_message","message","classList","remove","add","textContent","_clear","innerHTML","async","response","fetch","ok","Error","status","ip","IP","json","getElementById","value","error","address","_get_my_IP","$c10fc4dd470a6ad9$export$467bd201150db086","statusText","makeCorrectCase","_get_res_data","as","route","split","slice","join","exact_IP","_get_route_location","data","location","insertAdjacentHTML","$b209cf9df5f631c1$export$751a7c2349f9bdd6","addEventListener","e","preventDefault","userInput","filter","el","length"],"version":3,"file":"index.22e09c45.js.map"}